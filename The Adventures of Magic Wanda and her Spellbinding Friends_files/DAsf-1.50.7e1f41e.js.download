!function(){function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e,t,n,a,o,i){try{let r=null;if(window.XMLHttpRequest?r=new XMLHttpRequest:i(),r){if(r.onreadystatechange=()=>{o(r)},r.open(t,e,!0),null!==a)for(const e in a)r.setRequestHeader(e,a[e]);r.send(n)}else i()}catch(e){i()}}class n{logTrace(e,t){if(void 0!==this.traceId){let n;const a=(new Date).getTime();this.storedTrace.hasOwnProperty(e)||(this.storedTrace[e]=[]);t===Object(t)?n=Object.assign&&"function"==typeof Object.assign?Object.assign({},t):JSON.parse(JSON.stringify(t)):(n='{ "'+e+'":"'+t+'"}',n=JSON.parse(n)),n.timeStamp=a,n.timeSinceAdStart=a-this.adStartTime,this.storedTrace[e].push(n)}}constructor(n,a){e(this,"traceId",void 0),e(this,"adStartTime",void 0),e(this,"storedTrace",void 0),e(this,"allData",void 0),this.traceId=n,this.adStartTime=a,this.storedTrace={};void 0!==n&&(()=>{const e=()=>{const e=()=>{console.log("failed to send request to /gp/adbarplus")},n=t=>{4===t.readyState&&200!==t.status&&e()};if(!(e=>{for(const t in e)if(e.hasOwnProperty(t))return!1;return!0})(this.storedTrace)){t("/gp/adbarplus?traceId="+this.traceId+"&systemName=browser","POST",JSON.stringify(this.storedTrace),{"Content-Type":"application/x-www-form-urlencoded"},n,e);for(const e in this.storedTrace)this.storedTrace.hasOwnProperty(e)&&delete this.storedTrace[e]}},n=(e,t)=>()=>e.apply(t),a=()=>{e()},o=()=>{e(),window.setInterval(n(a,this),3e3)};"loading"!==document.readyState?n(o,this)():window.addEventListener("load",n(o,this))})()}}var a,o,i=new RegExp(/((&#[0-9]{2};)|(&#[0-9]{3};)|(&#[0-9]{4};)|(&[a-z]{2};)|(&[a-z]{3};)|(&[a-z]{4};)|(&[a-z]{5};)|(&[a-z]{6};)|(&[a-z]{7};)|(%[a-fA-F0-9]{2})|(\W))pd_rd_plhdr(=|%3D)t((&#[0-9]{2};)|(&#[0-9]{3};)|(&#[0-9]{4};)|(&[a-z]{2};)|(&[a-z]{3};)|(&[a-z]{4};)|(&[a-z]{5};)|(&[a-z]{6};)|(&[a-z]{7};)|(%[a-fA-F0-9]{2})|(\W))/),r="$1",s="$14";o=function(){return document};var d="data-val";function l(e){if("string"!=typeof e||""===e)return"";var t=o().getElementById("ape_"+e+"_placement_ClickTracking");if(!(t&&t.hasAttribute&&"function"==typeof t.hasAttribute&&t.hasAttribute(d)&&t.getAttribute&&"function"==typeof t.getAttribute))return"";var n=t.getAttribute(d);return"string"!=typeof n?"":n}a=function(e,t,n){return l([e,n,t].join("_"))};const c=e=>{if(!("pageType"in e)||!("subPageType"in e)||!("slotName"in e))return"";try{return a(e.pageType,e.subPageType,e.slotName)}catch(e){return""}},u=()=>window.P&&window.P.AUI_BUILD_DATE,p=(e,t,n)=>{var a;return u()&&"function"==typeof(null===window||void 0===window||null===(a=window.P)||void 0===a?void 0:a.guardError)?P.guardError("APE-SafeFrame",e):(...a)=>{try{e(...a)}catch(e){"function"==typeof t&&n&&t(n,e)}}},m=(e,t)=>{if(e&&t)for(const n in t)e.style[n]=t[n];return e},f={1027:"Sponsored Display DRA"},h=(e,t)=>(e=>"V"===e)(e)&&!f.hasOwnProperty(t),w={1:"Enabled",0:"NotEnabled","-1":"Unknown"},g=e=>(e=>{let t,n="";const a=e.length;for(let o=0;o<a;o++)t=e[o],n+=String.fromCodePoint(t>251&&t<254&&o+5<a?1073741824*(t-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>247&&t<252&&o+4<a?(t-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>239&&t<248&&o+3<a?(t-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:t>223&&t<240&&o+2<a?(t-224<<12)+(e[++o]-128<<6)+e[++o]-128:t>191&&t<224&&o+1<a?(t-192<<6)+e[++o]-128:t);return n})(((e,t)=>{const n=e.replace(/[^A-Za-z0-9+/]/g,""),a=n.length,o=t?Math.ceil((3*a+1>>2)/t)*t:3*a+1>>2,i=new Uint8Array(o);let r,s,d=0,l=0;for(let e=0;e<a;e++)if(s=3&e,d|=((c=n.charCodeAt(e))>64&&c<91?c-65:c>96&&c<123?c-71:c>47&&c<58?c+4:43===c?62:47===c?63:0)<<6*(3-s),3===s||a-e==1){for(r=0;r<3&&l<o;)i[l]=d>>>(16>>>r&24)&255,r++,l++;d=0}var c;return i})(e));var E,y,S,v,b,T;(y=E||(E={})).START="adload_start",y.CALLBACK="adload_delayload",y.IFRAME_CREATED="adload_iframecreated",(v=S||(S={})).SF_LIBRARY="sflibrary_",v.SF_HTML="sfhtml_",(T=b||(b={})).REQUEST="adfeedback_request",T.SUCCESS="adfeedback_success",T.ERROR="adfeedback_error",T.LABEL_RENDER="adfeedback_sponsoredlabelrender";const I={1:"abpstatus_enabled",0:"abpstatus_notenabled","-1":"abpstatus_unknown"};var A,R,D,N,_,M,L,O,C,k;function F(e){return window[e]&&"object"==typeof window[e].adDetails?window[e].adDetails:null}function x(e,t,n,a,o){let i;if(function(e){e.bb="uet",e.af="uet",e.cf="uet",e.be="uet",e.ld="uex"}(i||(i={})),!i.hasOwnProperty(e))return;const r=i[e].toString(),s=a?a+":":"";"function"==typeof window[r]&&(window[r].apply(this,H(e,"adplacements:"+s+t.replace(/_/g,":"),{wb:1},o)),n&&window[r].apply(this,H(e,"adplacements:"+s+n,{wb:1},o)))}function z(e,t,n,a){if(window.ue&&"function"==typeof window.ue.count){let o="adplacements:"+n;if(e&&(o+=":"+e.replace(/_/g,":")),window.ue.count(o,a),t){const e="adplacements:"+(n&&t?n+":":n)+t;window.ue.count(e,a)}}}function B(e,t,n,a){if(window.ue&&window.ue.tag){if(t){const n=e+":"+t.replace(/_/g,":")+(a?":"+a:"");window.ue.tag(n)}if(n){const t=e+":"+n+(a?":"+a:"");window.ue.tag(t)}t||n||window.ue.tag(e+(a?":"+a:""))}}function H(e,t,n,a){const o=[e,t,n];return a&&o.push(a),o}(A||(A={})).VERSION="sfversion_",(D=R||(R={})).LOGGING_FAILED="resourceTimingData_LoggingFailed",D.LOGGING_SUCCESSFUL="resourceTimingData_LoggingSuccessful",D.DEPENDENCIES_NOT_MET="resourceTimingData_DependenciesNotMet",D.DEPENDENCIES_MET="resourceTimingData_DependenciesMet",(_=N||(N={})).START="adload:start",_.CALLBACK="adload:delayloadcallback",_.IFRAME_CREATED="adload:iframecreated",(L=M||(M={})).SF_LIBRARY="cache:sflibrary:",L.SF_HTML="cache:sfhtml:",(C=O||(O={})).REQUEST="adfeedback:request",C.SUCCESS="adfeedback:success",C.ERROR="adfeedback:error",C.LABEL_RENDER="adfeedback:sponsoredlabelrender",(k||(k={})).API="messenger:";const U={1:"abpstatus:enabled",0:"abpstatus:notenabled","-1":"abpstatus:unknown"},V={VERSION:"sfversion"};var j,G;(G=j||(j={})).NEXUS_CLIENT_NOT_DEFINED="ResourceTimingData.NexusClientNotDefined",G.LOGGING_FAILED="ResourceTimingData.LoggingFailed",G.LOGGING_SUCCESSFUL="ResourceTimingData.LoggingSuccessful",G.DEPENDENCIES_NOT_MET="ResourceTimingData.DependenciesNotMet";const J={ALLOWLISTED:"custommessage:allowlisted",NOT_ALLOWLISTED:"custommessage:notallowlisted"};var W,q;(q=W||(W={})).PAGE_PRERENDER="pixelcondition:pageprerender",q.AD_MISSING="pixelcondition:admissing";const Q=()=>window.innerHeight||document.documentElement.clientHeight,Y=()=>window.innerWidth||document.documentElement.clientWidth,K=e=>e.getBoundingClientRect().top-Q(),X=e=>{const t={atf:$(e)};if(!e||!window||!document)return t;const n=ae(),a=oe(e),o=se(e);return{atf:$(e),geom:{win:n,self:a,exp:o},payload:{wh:n.h,ww:n.w,sx:window.scrollX,sy:window.scrollY,ah:a.h,aw:a.w,top:a.t,left:a.l}}},$=e=>{if(!e)return"unknown";const t=function(e){if(!window||!(null===document||void 0===document?void 0:document.body))return null;const t=ie(e,null),n=Q(),a=Y(),o=document.body.getBoundingClientRect(),i=Math.max(0,Math.min(o.left+a,t.r)-t.l),r=Math.max(0,Math.min(o.top+n,t.b)-t.t),s=i*r/(t.h*Math.min(t.w,a));return Number(Math.min(1,Math.max(0,s)).toFixed(2))}(e);return null==t?"unknown":t>=.5};const Z=e=>{if(!window||!document)return null;const t=te(e),n=ae(),a=oe(null,t);return{atf:"unknown",geom:{win:n,self:a,exp:se(null,t)},payload:{wh:n.h,ww:n.w,sx:window.scrollX,sy:window.scrollY,ah:a.h,aw:a.w,top:a.t,left:a.l}}},ee=(e,t)=>{const n=ie(e),a=ie(t),o=Y(),i=Q();return n&&a&&(Math.abs(n.t-a.b)<i||Math.abs(n.b-a.t)<i)&&(Math.abs(n.l-a.r)<o||Math.abs(n.r-a.l)<o)},te=e=>{const t=e.initialBoundingRect,n=t.top-(window.scrollY-e.originalScrollY),a=n+e.adHeight,o=t.left-(window.scrollX-e.originalScrollX);return{top:n,bottom:a,left:o,right:o+e.adWidth,width:e.adWidth,height:e.adHeight}},ne=(e,t,n)=>{let a=0;return"visible"!==document.visibilityState?a:(a=e>0?n-e:t>0?Math.min(t,n):0,Math.min(a,t-e))},ae=()=>{const e=window.screenY?window.screenY:window.screenTop,t=window.screenX?window.screenX:window.screenLeft,n=Y(),a=Q();return{t:e,l:t,w:n,h:a,b:e+a,r:t+n}},oe=(e,t)=>{const n=ie(e,t),a=re(n);return{t:n.t,l:n.l,r:n.r,b:n.b,w:n.w,h:n.h,z:n.z,xiv:a.xiv,yiv:a.yiv,iv:a.iv}},ie=(e,t)=>{const n=t||(null==e?void 0:e.getBoundingClientRect());return{t:n.top,l:n.left,r:n.right,b:n.bottom,w:n.width,h:n.height,z:e?Number(window.getComputedStyle(e,null).zIndex):NaN}},re=e=>{const t=Y(),n=Q(),a=Math.max(0,ne(e.t,e.b,n)),o=Math.max(0,ne(e.l,e.r,t)),i=a*o,r=e.h*Math.min(e.w,t);return 0!==r||0!==i?{xiv:Number(Math.min(1,o/e.w).toFixed(2)),yiv:Number(Math.min(1,a/e.h).toFixed(2)),iv:Number(Math.min(1,Math.max(0,i/r)).toFixed(2))}:{xiv:0,yiv:0,iv:0}},se=(e,t)=>{const n=t||(null==e?void 0:e.getBoundingClientRect());return{t:n.top,l:n.left,r:Y()-n.right,b:Q()-n.bottom,xs:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)>Y()?1:0,yx:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)>Q()?1:0}};function de(e,t,n){var a,o=n||{},i=o.noTrailing,r=void 0!==i&&i,s=o.noLeading,d=void 0!==s&&s,l=o.debounceMode,c=void 0===l?void 0:l,u=!1,p=0;function m(){a&&clearTimeout(a)}function f(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var s=this,l=Date.now()-p;function f(){p=Date.now(),t.apply(s,o)}function h(){a=void 0}u||(d||!c||a||f(),m(),void 0===c&&l>e?d?(p=Date.now(),r||(a=setTimeout(c?h:f,e))):f():!0!==r&&(a=setTimeout(c?h:f,void 0===c?e-l:e)))}return f.cancel=function(e){var t=(e||{}).upcomingOnly,n=void 0!==t&&t;m(),u=!n},f}class le{sendLatencyMetric(e){var t;x(e.latencyMetricType.csmKey,e.placementName,e.placementId,e.latencyMetricType.csmMessage,null===(t=e.timestamp)||void 0===t?void 0:t.getTime()),function(e){const t=(n=e.placementName,document.getElementById(function(e){return"ape_"+e+"_placement"}(n)));var n;if(t){var a;Ve(t),je(e.latencyMetricType.csaKey,null===(a=e.timestamp)||void 0===a?void 0:a.getTime())}}(e)}}const ce=()=>new le,ue="sfImpression",pe="PollingSfImpression",me="LightAdImpression",fe="Polling_LightAdImpression",he=(e,t,n)=>({csaKey:e,csmKey:t,csmMessage:n}),we=he("bodyBegin","bb",ue),ge=he("bodyBegin","bb",pe),Ee=(he("bodyBegin","bb",me),he("bodyBegin","bb",fe),he("bodyEnd","be"),he("clickToATF","af")),ye=he("criticalFeature","cf"),Se=(he("criticalFeature","cf",ue),he("criticalFeature","cf",me),he("loaded","ld"),he("loaded","ld",ue),he("loaded","ld",pe),he("loaded","ld",me),he("loaded","ld",fe),he("viewablelatency:loaded","ld","viewablelatency")),ve="ERROR";function be(e,t){const n=t||new Error(e);console.error(e,t),z("",null,"safeFrameError",1),window.sfHostLogErrors&&(window.ueHostLogError?window.ueHostLogError(n,{logLevel:ve,attribution:"APE-safeframe",message:e+" "}):"undefined"!=typeof console&&console.error&&console.error(e,n))}const Te=()=>{const e=window.location.hostname.split(".").pop();let t="na";return/^(com|ca|mx|br)$/.test(e)?t="na":/^(uk|de|fr|it|es|in|ae|sa|nl|tr|se|pl|eg|be)$/.test(e)?t="eu":/^(jp|au|sg)$/.test(e)?t="fe":/^(cn)$/.test(e)&&(t="cn"),"https://images-"+t+".ssl-images-amazon.com"},Ie=(e,t)=>e.height===t.height&&e.width===t.width,Ae=(e,t,n)=>{if(!t||"object"!=typeof t)return!1;for(let a=0,o=t.length;a<o;a++)if(n(e,t[a]))return!0;return!1},Re=()=>"IntersectionObserver"in window&&"IntersectionObserverEntry"in window,De=e=>e&&0===Object.keys(e).length&&e.constructor===Object;function Ne(e,t){const n=document.createElement("iframe");return n.name=JSON.stringify(e),n.id=t,n.height=Fe(e.size.height)||"250px",n.width=Fe(e.size.width)||"300px",n.className=e.iframeClass||"",n.setAttribute("frameborder","0"),n.setAttribute("marginheight","0"),n.setAttribute("marginwidth","0"),n.setAttribute("scrolling","no"),n.setAttribute("allowtransparency","true"),n.setAttribute("data-arid",e.arid),n.style.cssText=e.iframeExtraStyle||"",n}const _e=["allow-scripts","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"],Me=_e.concat(["allow-same-origin"]),Le=(e,t,n)=>{const a=Ne(e,t);return a.srcdoc=decodeURIComponent(n),a.sandbox=_e.join(" "),a},Oe=(e,t,n)=>{const a=Ne(e,t);return a.src=n,a.sandbox=Me.join(" "),a};function Pe(e){const t=document.getElementById(e);void 0!==t&&t&&(t.style.display="none")}function Ce(e,t,n){const a=document.getElementById(t[e].placementDivId),o=document.getElementById(t[e].wrapperDivId)||a,i=document.getElementById(t[e].iframeId);let r=n.resizePlacementWidthThreshold;const s=n.resizePlacementStyleAboveThreshold,d=n.resizePlacementStyleBelowThreshold;r=parseInt(r,10),o&&i&&r&&s&&d&&(o.offsetWidth<r?m(i,d):m(i,s))}function ke(e,t,n,a,o,i){try{const r=document.getElementById(i[e].placementDivId),s=document.getElementById(i[e].wrapperDivId)||r,d=document.getElementById(i[e].iframeId);if(null===s||null===r||null===d)return;const l=xe(n),c=xe(t),u=!c&&!l,p=parseInt(t,10);let m=c?d.offsetWidth:p,f=l?d.offsetHeight:parseInt(n,10);const h=parseInt(a,10),w=e=>{u&&(f=Math.round(e*f/m)),m=Math.round(e)},g=0===s.offsetWidth?Y():s.offsetWidth;h&&Q()<Y()?w(h):w(g),o&&o.adMap&&o.adMap[e]&&o.adMap[e].options&&o.adMap[e].options.slotSnapshot&&(o.adMap[e].options.slotSnapshot.adHeight=f,o.adMap[e].options.slotSnapshot.adWidth=m);const E=Fe(m),y=Fe(u?f:n);d.style.height=y,d.style.width=E;const S={width:E,height:y};s!==r&&(r.style.height=y,o.sendMessageToAd(e,"resizeCreativeWrapper",S)),"Detail_hero-quick-promo_Desktop"===i[e].slotId&&(z(i[e].slotId,o.adMap[e].options.placementId,"OffsetLeft",d.offsetLeft),z(i[e].slotId,o.adMap[e].options.placementId,"OffsetTop",d.offsetTop),z(i[e].slotId,o.adMap[e].options.placementId,"OffsetWidth",d.offsetWidth),z(i[e].slotId,o.adMap[e].options.placementId,"OffsetHeight",d.offsetHeight))}catch(t){be("Error resizing ad: "+i[e].slotId,t)}}function Fe(e){return!e||xe(e)||function(e){return e.length>2&&"px"===e.substring(e.length-2)}(e)?e:e+"px"}function xe(e){return e.length>1&&"%"===e.charAt(e.length-1)}function ze(e,t,n,a,o){const i="undefined"!=typeof P,r="undefined"!=typeof amznJQ,s="number"==typeof n&&0!==n?()=>{setTimeout(t,n)}:t,d=!!o&&JSON.parse(o);if(void 0===e)s();else if("windowOnLoad"===e)"complete"===document.readyState?s():window.addEventListener("load",s);else if("spATFEvent"===e)i?P.when("search-page-utilities").execute((e=>{window.searchPageUtils.afterEvent("spATFEvent",s)})):r?amznJQ.available("search-js-general",(()=>{window.SPUtils.afterEvent("spATFEvent",s)})):s();else if("aboveTheFold"===e)i?P.when("af").execute(s):r?amznJQ.onCompletion("amznJQ.AboveTheFold",s):s();else if("criticalFeature"===e)i?P.when("cf").execute(s):r?amznJQ.onCompletion("amznJQ.criticalFeature",s):s();else if("r2OnLoad"===e)i?P.when("r2Loaded").execute(s):r?amznJQ.onReady("r2Loaded",s):s();else if(e.match("[^:]+:.+")){const t=e.split(":"),n=t[0].split("."),a=t[1],o=t.length>2?t[2]:a;i?P.when(o,"A").execute(s):r&&n.length>1?amznJQ[n[1]](a,s):s()}else if(e.match(/^\d{1,4}px$/g))Be(parseInt(e,10),s,a,d,((e,t)=>{const n=K(e);return e&&n<=t}));else{const t=/^reached(\d{1,5}px)FromTop$/g.exec(e);t?Be(parseInt(t[1],10),s,a,d,((e,t)=>window.scrollY+Q()>=t)):s()}}function Be(e,t,n,a,o){let i=!1;const r=()=>{o(n,e)&&(t(),i=!0)},s=p(de(20,(()=>{r(),i&&(window.removeEventListener("scroll",s),window.removeEventListener("resize",s))})));window.addEventListener("scroll",s),window.addEventListener("resize",s),a&&r()}const He=new class{customMessage(e,t,n,a,o){const i=this.msgListeners;try{"undefined"!==n&&Array.isArray(n)&&(n.indexOf(e)>-1&&i[e]?(z(null,null,J.ALLOWLISTED+":"+e,1),i[e](t)):-1===n.indexOf(e)?(z(null,null,J.NOT_ALLOWLISTED,1),z(a,o,J.NOT_ALLOWLISTED,1)):be("Unrecognized custom message key: "+e))}catch(e){be("Custom Message Error",e)}}isElementInDOM(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}constructor(t,n,a){e(this,"adMap",void 0),e(this,"supportedCommands",void 0),e(this,"msgListeners",void 0),e(this,"getIframe",(e=>{var t;const n=this.adMap,a=n[e].options;if(De(n)||De(a))return null;const o="ape_"+a.slot+"_iframe";return n[e].iframe&&(n[e].iframe=n[e].iframe&&(null===(t=n[e].iframe)||void 0===t?void 0:t.innerHTML)?n[e].iframe:document.getElementById(o)),n[e].iframe})),e(this,"sendMessageToAd",((e,t,n)=>{const a=this.getIframe(e),o=a?a.contentWindow:null;if(o){const e={command:t,data:n};o.postMessage(e,"*")}})),e(this,"receiveMessage",(e=>{const t=e=>{for(const n in this.adMap){var t;if((null===(t=this.getIframe(n))||void 0===t?void 0:t.contentWindow)===e.source)return!0}return!1},n=this.adMap;if(De(n))return;try{var a,o,i,r;if((null===(r=null==e||null===(a=e.data)||void 0===a||null===(o=a.message)||void 0===o||null===(i=o.id)||void 0===i?void 0:i.toLowerCase())||void 0===r?void 0:r.indexOf("mash"))>-1)throw"Received Mash message"}catch(e){return}const s=e.data,d=n[s.arid];try{const n=this.supportedCommands,a=((e,n)=>e&&e.options&&t(n))(d,e);if("object"!=typeof s.data||!n.hasOwnProperty(s.command))return;if(!a)throw"Invalid Message Origin: "+e.origin;const o=n[s.command];o&&(d.options.debug&&"undefined"!=typeof console&&console.log(e),o(d,s.data))}catch(t){let n="Problem with message: "+e.data;void 0!==s&&(n+=this.appendErrorDetails(s.arid)),be(n,t)}})),e(this,"appendErrorDetails",(e=>{const t=this.adMap;if(De(t))return"";let n="";if(void 0!==t[e]){const a=t[e].options;void 0!==a.aanResponse&&(n=" Ad Details: "+JSON.stringify(a.aanResponse))}return n})),e(this,"registerCustomMessageListener",((e,t,n)=>{let a=!1;const o=this.msgListeners;try{if(!o[e]||"function"!=typeof o[e]||n)o[e]=t,a=!0;else{be("Duplicate Key",new Error("Custom message listener already exists for key: "+e))}}catch(e){be("Error registering custom message listener",e)}return a})),e(this,"sendCustomMessage",((e,t)=>{const n=this.adMap,a={key:e,data:t};for(const e in n)this.sendMessageToAd(e,"customMessage",a)})),e(this,"sendCustomMessageToAd",((e,t,n)=>{const a={key:t,data:n};this.sendMessageToAd(e,"customMessage",a)})),e(this,"takeSnapshotOfSlotPosition",(e=>{const t=this.adMap,n=t&&t[e]&&t[e].options;if(!t||De(t)||!n||De(n))return;const a=this.getIframe(e);var o;this.adMap[e].options.slotSnapshot={initialBoundingRect:(o=a).getBoundingClientRect(),adHeight:o.offsetHeight,adWidth:o.offsetWidth,originalScrollX:window.scrollX,originalScrollY:window.scrollY}})),e(this,"startPixelTracking",((e,t)=>{let n="prerender"!==document.visibilityState;const a=this.getIframe(e);let o,i,r=this.isElementInDOM(a);const s=this.adMap&&this.adMap[e]&&this.adMap[e].options;!n&&s&&z(s.slot,s.placementId,W.PAGE_PRERENDER,1),!r&&s&&z(s.slot,s.placementId,W.AD_MISSING,1);const d=()=>!(!n||!r)&&(t(),i&&document.removeEventListener("visibilitychange",i),o&&Re()&&o.unobserve(a),!0);if(!d()){const e={root:document.documentElement};Re()&&(o=new IntersectionObserver((e=>{try{if(1===e.length){e[0].isIntersecting?(r=!0,d()):r=!1}}catch(e){be("Error executing intersectionObserver callback")}}),e),o.observe(a)),i=()=>{try{"prerender"!==document.visibilityState?(n=!0,d()):n=!1}catch(e){be("Error executing pageVisibilityHandler callback")}},document.addEventListener("visibilitychange",i)}})),e(this,"updateViewability",(e=>{const t=this.adMap,n=t&&t[e]&&t[e].options;if(!t||De(t)||!n||De(n))return;const a=this.getIframe(e),o=t[e].options.viewabilityStandards,i=X(a);null!==i&&(i.viewabilityStandards=o,this.sendMessageToAd(e,"updateViewability",i))})),e(this,"updateNoInventoryViewability",(e=>{const t=this.adMap,n=t&&t[e]&&t[e].options,a=n&&n.slotSnapshot;if(!t||De(t)||!n||De(n)||!a)return;const o=n.viewabilityStandards,i=Z(a);null!==i&&(i.viewabilityStandards=o,this.sendMessageToAd(e,"updateViewability",i))})),this.adMap=t||{},this.supportedCommands=n||{},this.msgListeners=a||{}}};const Ue=new class{constructor(){e(this,"latencyPlugin",void 0),e(this,"events",void 0)}},Ve=e=>{window.csa?Ue.latencyPlugin=window.csa("Content",{element:e}):console.log(window)},je=(e,t)=>{try{Ue.latencyPlugin("mark",e,t)}catch(e){be("Error with initiating CSA",e)}},Ge=(e,t,n)=>{try{Ue.events("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t+":"+n,metricValue:1},{ent:"all"})}catch(e){be("Error with initiating CSA",e)}},Je=e=>{try{Ue.events("setEntity",{adCreativeMetaData:e})}catch(e){be("Error with initiating CSA",e)}};function We(e,t,n){const a=Qe(e,t);if(!a)return;(a.getElementsByTagName("div")[0]||Ye("div",{},t.advertisementStyle,a,null)).innerHTML=g(t.adFeedbackInfo.sponsoredText),n[t.arid].logTrace("adFeedBack",{renderSponsoredLabel:!0}),z(t.slot,t.placementId,O.LABEL_RENDER,1),Ge(b.LABEL_RENDER,t.slot,t.placementId)}function qe(e,n,a){const o=Qe(e,n);if(!o)return;e.isFeedbackLoaded=!0;const i=e.parentNode,r=n.placementId,s=n.adFeedbackInfo.endPoint,d=n.feedbackDivStyle,l={adPlacementMetaData:n.adPlacementMetaData,adCreativeMetaData:n.adCreativeMetaData},c={isFeedbackLoaded:e.isFeedbackLoaded,slot:i,placementId:r,endPoint:s,feedbackDivStyle:d,adFeedbackParams:l,requestUrl:""},u=e=>{const t={feedbackResponseStarted:!0,feedBackResponseReturned:!1,response:""};if(4===e.readyState){if(200===e.status)try{const a=e.responseText,i=JSON.parse(a);if(t.response=i,i&&"ok"===i.status){if("html"in i&&i.html&&(o.innerHTML=i.html),"script"in i&&i.script){(o.getElementsByTagName("script")[0]||Ye("script",{},{},o,null)).innerHTML=i.script}z(n.slot,r,O.SUCCESS,1),Ge(b.SUCCESS,n.slot,r),t.feedBackResponseReturned=!0}}catch(e){z(n.slot,n.placementId,O.ERROR,1),Ge(b.ERROR,n.slot,n.placementId)}a[n.arid].logTrace("adFeedBack",{adFeedBackResponse:t})}},p=s&&s.length?window.location.protocol+"//"+window.location.hostname+s+"?pl="+(m=l,encodeURIComponent(JSON.stringify(m))):s;var m;c.requestUrl=p,a[n.arid].logTrace("adFeedBack",{adFeedbackRequest:c}),p&&(z(n.slot,r,O.REQUEST,1),Ge(b.REQUEST,n.slot,r),t(p,"GET",null,null,u,(()=>{})))}function Qe(e,t){if(!e||!t.adFeedbackInfo.boolFeedback||e.isFeedbackLoaded)return null;const n=e.parentNode,a=t.feedbackDivStyle,o=t.adFeedbackInfo.adFeedbackOnTop;return n.getElementsByTagName("div")[0]||Ye("div",{id:n.id+"_Feedback"},a,n,o?n.firstChild:null)}function Ye(e,t,n,a,o){const i=document.createElement(e);for(const e in t)i.setAttribute(e,t[e]);return m(i,n),a.insertBefore(i,o),i}const Ke=e=>{e.fallbackStaticAdClickUrl&&((e=>{let t="";return e&&(t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]),0!==t.length})(e.fallbackStaticAdClickUrl)||(e.fallbackStaticAdClickUrl=window.location.protocol+"//"+window.location.host+e.fallbackStaticAdClickUrl))},Xe={};function $e(e,t,n){e&&e.id&&!Xe[e.id]&&window.P&&u()&&window.P.when("gw-video-orchestrator").execute((a=>{a.subscribe(e,t,n),Xe[e.id]=!0}))}let Ze=null;function et(e,t,n){const a=t=>{n.sendCustomMessageToAd(e.options.arid,"videoAutoplayResponse",t)};var o;e.options.expParams&&e.options.expParams.noVideoAutoplay?a(!1):(o=e.options.pageType)&&"gateway"===o.toLowerCase()?$e(e.iframe,a,t):Ze===e.options.arid?a(!0):null===Ze&&function(e){const t=document.getElementsByTagName("video");for(let n=0;n<t.length;++n)if(!t[n].paused&&ee(e,t[n]))return!1;return!0}(e.iframe)?(Ze=e.options.arid,a(!0)):a(!1)}function tt(){u()&&window.P&&window.P.when("gw-video-orchestrator").execute((e=>{e.elect()})),Ze=null}function nt(e){var t;(t=e.iframe)&&window.P&&u()&&window.P.when("gw-video-orchestrator").execute((e=>{e.elect(t)})),Ze=e.options.arid}const at="unfired_cod_impressions_dictionary";function ot(){let e;try{e=JSON.parse(localStorage.getItem(at)||"{}")}catch(t){e={}}return e}function it(){try{localStorage.removeItem(at)}catch(e){}}function rt(e,t){const n=ot();n[e]=t,lt(n)}function st(){const e=ot(),t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&""!==e[n]&&t.push(e[n]);return it(),t}function dt(e){const t=ot();t[e]&&(t[e]="",lt(t))}function lt(e){try{localStorage.setItem(at,JSON.stringify(e))}catch(e){}}var ct,ut,pt,mt,ft,ht;(ut=ct||(ct={})).IMPRESSION="localstorage:impression",ut.ERROR="localstorage:error",ut.CONTROL="localstorage:inactive",ut.TREATMENT="localstorage:t1",ut.NO_WEBLAB="localtestorage:missing",(mt=pt||(pt={})).IMPRESSION="localstorage_impression",mt.ERROR="localstorage_error",mt.CONTROL="localstorage_inactive",ht=function(){return URL};var wt="{}",gt="?",Et="&",yt="=";function St(e,t){var n={};for(var a in e)n[a]=e[a];for(var o in t)n[o]=t[o];return n}ft=function(e,t,n){if("string"!=typeof e||""===e)throw new Error("Invalid url input to addJSONQueryParamToURL: "+JSON.stringify({url:e}));if("string"!=typeof t||""===t)throw new Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));if("object"!=typeof n)throw new Error("Invalid queryParamValueObject input to addJSONQueryParamToURL: "+JSON.stringify({queryParamValueObject:n}));try{var a=new(ht())(e),o=a.searchParams.get(t)?a.searchParams.get(t):"{}",i=JSON.parse(o);if("object"!=typeof i)throw new Error("Existing query param value was not an object: "+JSON.stringify({existingJSONObject:i}));var r=St(i,n);return a.searchParams.set(t,JSON.stringify(r)),a.toString()}catch(a){return function(e,t,n){var a,o=e.indexOf(gt),i={};if(o>0){a=e.substring(0,o),decodeURIComponent(e.substring(o+1)).split(Et).forEach((function(e){if(e){var t=e.split(yt);i[t[0]]=t[1]}}));var r=i[t]?i[t]:wt,s=JSON.parse(r);if("object"!=typeof s)throw new Error("Existing query param value was not an object: "+JSON.stringify({existingJSONObject:s}));var d=St(s,n);i[t]=JSON.stringify(d)}else a=e,i[t]=JSON.stringify(n);var l=[];for(var c in i)l.push(encodeURIComponent(c)+yt+encodeURIComponent(i[c]));return a+gt+l.join(Et)}(e,t,n)}};const vt=(e,t)=>{const n=!(!e.options.expParams||!e.options.expParams.enableViewabilityTrackerOnLoad)&&JSON.parse(e.options.expParams.enableViewabilityTrackerOnLoad),a=()=>{try{dt(e.options.arid),He.sendMessageToAd(e.options.arid,"fireImpression",t),bt(!n,e,t)}catch(e){be("Error firing pixels. data: "+JSON.stringify(t))}};bt(n,e,t);const o=p((()=>{He.startPixelTracking(e.options.arid,a)}));ze(e.options.firePixelsAfter,o,0,e.slot,e.options.expParams?e.options.expParams.firePositionTrackerOnLoad:"false")},bt=(e,t,n)=>{e&&(n.isNoInventory?He.supportedCommands.enableNoInventoryViewabilityTrackerAndInvokeFallback(t):He.supportedCommands.enableViewabilityTracker(t))};function Tt(e){He.startPixelTracking(e.options.arid,(()=>{try{if(e.options.aaxImpPixelUrl){const t=ft(e.options.aaxImpPixelUrl,"pj",{measurementMethod:"cod_client"});rt(e.options.arid,t)}He.sendMessageToAd(e.options.arid,"fireMetricsForLegacyImpression",{})}catch(e){be("Error firing legacy impression metrics")}}))}function It(e,t){He.startPixelTracking(e.options.arid,(()=>{try{He.sendMessageToAd(e.options.arid,"fireMetricsForCremPolling",{isBtr:t.isBtr})}catch(e){be("Error firing crem polling impression metrics")}}))}const At={sd:1},Rt=["name","entryType","startTime","duration","initiatorType","nextHopProtocol","workerStart","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","transferSize","encodedBodySize","decodedBodySize"];class Dt{log(){if(!(window.ue&&window.ue.event&&window.ue.attach))return z(null,null,j.DEPENDENCIES_NOT_MET,1),void Ge(R.DEPENDENCIES_NOT_MET,this.options.slot,this.options.placementId);z(null,null,j.DEPENDENCIES_NOT_MET,0),Ge(R.DEPENDENCIES_MET,this.options.slot,this.options.placementId),"complete"===document.readyState?this.logMessage():window.ue.attach("load",this.logMessage)}extractResourceProperties(e){let t={};const n={};for(let a=0;a<Rt.length;a++)t=Rt[a],void 0!==e[t]&&(n[t]=e[t]);return n}getPageInfo(){return{source:"safeframe",pageType:window.ue_pty||null,subPageType:window.ue_spty||null,pageTypeId:this.getPageTypeIdKey()||null}}getPageTypeIdKey(){return this.options.slot+"_"+this.options.adCreativeMetaData.adNetwork+"_"+this.options.adCreativeMetaData.adProgramId+"_"+this.options.adCreativeMetaData.adCreativeId+"_"+this.options.adCreativeMetaData.adId}getResources(){const e=[];for(let t=0;t<this.data.resourceTimingData.length;t++){const n=this.data.resourceTimingData[t];0!==n.responseEnd&&e.push(this.extractResourceProperties(n))}return e}composeMessage(){const e=this.getPageInfo();return e.resourceData=this.getResources(),e}logMessage(){const e=this.composeMessage();let t=!1;window.ue.event&&(t=window.ue.event(e,"adplacements","csm.ResourceTimingHit.2",At),t?(z(null,null,j.LOGGING_SUCCESSFUL,1),z(null,null,j.LOGGING_FAILED,0),Ge(R.LOGGING_SUCCESSFUL,this.options.slot,this.options.placementId)):(z(null,null,j.LOGGING_SUCCESSFUL,0),z(null,null,j.LOGGING_FAILED,1),Ge(R.LOGGING_FAILED,this.options.slot,this.options.placementId)))}constructor(t,n){e(this,"options",void 0),e(this,"data",void 0),this.options=t,this.data=n}}function Nt(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{},o=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),o.forEach((function(n){e(t,n,a[n])}))}return t}function _t(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var Mt,Lt;(Lt=Mt||(Mt={})).BEGIN_TO_RENDER_CLIENT="btr_client",Lt.COUNT_ON_DOWNLOAD_CLIENT="cod_client";const Ot=(e,t,n,a,o)=>{const i=document.createElement("img");i.id=t,i.src=e,i.style.display="none",i.onload=a,i.onerror=o,n.appendChild(i)};var Pt,Ct,kt,Ft;!function(e){e.IFRAME_INIT="adload:iframeinitialized",e.RENDER_START="adload:renderstart",e.RENDER_END="adload:renderend",e.CREATIVE_WRITTEN="adload:creativewritten",e.IMP="adload:impression",e.UNSERVED_IMP="adload:unservedimpression",e.VIEWABILITY="adload:viewability",e.UNSERVED_VIEWABILITY="adload:unservedviewability",e.MEASURABILITY="adload:measurability",e.MEASUREMENT_HTML="adload:measurementhtml"}(Pt||(Pt={})),(kt=Ct||(Ct={})).REQUEST_START="adfetch:request",kt.PUNT_RETURNED="adfetch:punt",kt.ERROR_RETURNED="adfetch:error",kt.EMPTY_RESPONSE="adfetch:noad",kt.RENDERED_AD="adfetch:renderad",kt.RENDER_ERROR="adfetch:rendererror",kt.HTTP_ERROR="adfetch:httperror",kt.EXCEPTION="adfetch:exception",function(e){e.DEPENDENCIES_NOT_MET="ResourceTimingData.DependenciesNotMet"}(Ft||(Ft={}));var xt,zt,Bt,Ht,Ut,Vt;function jt(e,t,n,a,o,i){if("undefined"==typeof performance||void 0===performance.getEntriesByType)return;const r=performance.getEntriesByType("resource");if(void 0===r||!Array.isArray(r)||r.length<1||void 0===r[0].duration)return;const s=e=>{o(n,a,e,1)},d=void 0!==r[0].transferSize?(e,t,o)=>{0===e.transferSize?(s(t+"cached"),i(o+"cached",n,a)):(s(t+"uncached"),i(o+"uncached",n,a))}:(e,t,o)=>{e.duration<20?(s(t+"fastload"),i(o+"fastload",n,a)):(s(t+"slowload"),i(o+"slowload",n,a))},l=(e,t,n)=>{if(e)for(let a=0;a<r.length;a++){const o=r[a];if(o.name&&-1!==o.name.indexOf(e))return void d(o,t,n)}};l(e,M.SF_LIBRARY,S.SF_LIBRARY),l(t,M.SF_HTML,S.SF_HTML)}(zt=xt||(xt={})).LEGACY_IMPRESSION_COUNTER="imp:legacy",zt.GLOBAL_IMPRESSION_FIRED_COUNTER="impressionFired",(Ht=Bt||(Bt={})).LOADED="btr:loaded",Ht.ERROR="btr:error",Ht.IMPRESSION="btr:impression",Ht.NO_IMAGES="btr:noimages",Ht.TAGGED="btr:taggedcreative",(Vt=Ut||(Ut={})).POLL_END="crem:pollingcomplete",Vt.POLL_BTR="crem:pollingisbtr";const Gt=(e,t)=>{const n=(e,t)=>{var n,a;return null!==(a=null===(n=document.getElementById(e))||void 0===n?void 0:n.getAttribute(t))&&void 0!==a?a:null},a=n("ilmRelocatedHtml","data-relocated-html");a?He.sendMessageToAd(e,"sendRelocatedHtmlContentEncodedToAd",a):document.addEventListener("sendRelocatedHtmlContentEncodedToAd",(a=>{const o=n("ilmRelocatedHtml","data-relocated-html");o?He.sendMessageToAd(e,"sendRelocatedHtmlContentEncodedToAd",o):t()}),{once:!0})},Jt=(e,t)=>{let n;try{n=ft(e,"pj",{measurementMethod:Mt.COUNT_ON_DOWNLOAD_CLIENT})}catch(e){return be("Unable to add pj to impression URL",e),z(null,null,ct.ERROR,1),void Ge(pt.ERROR)}Ot(n,"ape_impression",t,(()=>{z(null,null,ct.IMPRESSION+"loaded",1),Ge(pt.IMPRESSION+"loaded")}),(()=>{z(null,null,ct.IMPRESSION+"error",1),Ge(pt.IMPRESSION+"error")})),z(null,null,xt.GLOBAL_IMPRESSION_FIRED_COUNTER,1)},Wt=(e,t,n,a,o,i)=>{try{var r,s;const d=document.getElementById(a[e.arid].placementDivId),l=a[e.arid].iframeId;let c=null;const u="t1"===(null===window||void 0===window||null===(r=window.renderingWeblabs)||void 0===r||null===(s=r.ADPT_SF_CLIENT_LATENCY_2023Q1_632539)||void 0===s?void 0:s.toLowerCase()),p=h(e.mediaType,e.adCreativeMetaData.adProgramId);c=u&&!p?Le(e,l,n):Oe(e,l,t);const m=i?e.MAsfUrl:e.DAsfUrl;c.onload=()=>{jt(m,t,e.slot,e.placementId,z,Ge)},d.appendChild(c),ce().sendLatencyMetric({latencyMetricType:ye,placementId:e.placementId,placementName:e.slot}),z(e.slot,e.placementId,N.IFRAME_CREATED,1),Ge(E.IFRAME_CREATED,e.slot,e.placementId),He.adMap[e.arid]={slot:d,iframe:c,options:e};const f={id:c.id,src:c.src,scrolling:c.scrolling,height:c.height,width:c.width,className:c.className,styleCssText:c.style.cssText,sandbox:c.sandbox};o[e.arid].logTrace("createSafeFrame",f)}catch(t){be("Error creating safeFrame",t),o[e.arid]&&o[e.arid].logTrace("createSafeFrame",{error:{message:"errorCreatingSafeFrame",ex:t}})}},qt=(e,t)=>{ce().sendLatencyMetric(_t(Nt({},t),{placementName:e.options.slot,placementId:e.options.placementId}))};const Qt=new class{addAdHandler(e,t,n,a){this.ADS_HANDLERS[e]=this.ADS_HANDLERS[e]||{},this.ADS_HANDLERS[e][n]=p(a,be,"Error within ad handler "+n+": "+t)}constructor(t){e(this,"ADS_HANDLERS",{}),e(this,"AD_IDS",{}),e(this,"AD_TRACERS",{}),e(this,"buildTimeReplacements",void 0),e(this,"supportedCommands",{sendAdBarTrace:(e,t)=>{e.options.arid in this.AD_TRACERS&&this.AD_TRACERS[e.options.arid].logTrace(t.field,t.traceInfo)},logAPIInvocation:(e,t)=>{z(null,null,k.API+t.apiName,1),z(e.options.slot,e.options.placementId,k.API+t.apiName,1),e.options.arid in this.AD_TRACERS&&this.AD_TRACERS[e.options.arid].logTrace("apiCalls",t)},resizeSafeFrameAd:e=>{window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].defaultResizeSafeFrameHandler),ke(e.options.arid,e.options.size.width,e.options.size.height,e.options.maxAdWidth,He,this.AD_IDS)},setResizePlacementStyle:e=>{window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].defaultSetResizePlacementStyle),Ce(e.options.arid,this.AD_IDS,e.options.resizePlacementStyle)},changeSize:(e,t)=>{const n=e.options.allowedSizes;if(void 0===e.options.allowChangeSize||e.options.allowChangeSize)if(Ae(t,n,Ie))e.slot.style.width=t.width,e.iframe.height=t.height,e.iframe.width=t.width;else{be("Size is not allowlisted: "+t.width+" x "+t.height+He.appendErrorDetails(e.options.arid))}},startPixelTracking:vt,startPixelTrackingForLegacyImpression:Tt,startPixelTrackingForCremPolling:It,collapseSlot:e=>{Pe(this.AD_IDS[e.options.arid].placementDivId),Pe(this.AD_IDS[e.options.arid].auiCardDeckId),"nav-sitewide-msg"===e.options.slotName&&ze("amznJQ.available:navbarJSLoaded",(()=>{void 0!==parent.navbar&&"function"==typeof parent.navbar.unHideSWM&&parent.navbar.unHideSWM()}))},logError:(e,t)=>{be(t.message+He.appendErrorDetails(e.options.arid)+": "+e.options.slot,t.error)},logCsaEvent:(e,t)=>{Ge(t.metricName,e.options.slot,e.options.placementId)},addCsaEntity:(e,t)=>{Je(t)},sendLatencyMetric:(e,t)=>qt(e,t),countMetric:(e,t)=>{t.isGlobal?z(null,null,t.metricMsg,t.value):z(e.options.slot,e.options.placementId,t.metricMsg,t.value)},addCsmTag:(e,t)=>{t.isGlobal?B(t.tag,null,null,t.msg):B(t.tag,e.options.slot,e.options.placementId,t.msg)},fireViewableLatencyMetrics:(e,t)=>{var n,a,o,i;n=e.options.arid,a=e.options.slot,o=e.options.placementId,i=t.adLoadedTimestamp,window.apeViewableLatencyTrackers&&window.apeViewableLatencyTrackers[n]&&window.apeViewableLatencyTrackers[n].valid&&(window.apeViewableLatencyTrackers[n].loaded=!0,window.apeViewableLatencyTrackers[n].viewed&&(ce().sendLatencyMetric({latencyMetricType:Se,placementId:o,placementName:a,timestamp:new Date(i)}),z(a,o,"htmlviewed:loaded",1)))},customMessage:(e,t)=>{He.customMessage(t.key,t.body,e.options.allowlistedCustomMessageEvents,e.options.slot,e.options.placementId)},enableViewabilityTracker:e=>{He.updateViewability(e.options.arid);const t=de(20,He.updateViewability);if(this.addAdHandler(e.options.arid,e.options.slot,"viewabilityTracker",(()=>{t(e.options.arid)})),window.addEventListener("scroll",this.ADS_HANDLERS[e.options.arid].viewabilityTracker),window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].viewabilityTracker),document.addEventListener("visibilitychange",this.ADS_HANDLERS[e.options.arid].viewabilityTracker),Re()){new IntersectionObserver((()=>{He.updateViewability(e.options.arid)}),{threshold:[0,.5,1]}).observe(e.slot)}},enableNoInventoryViewabilityTrackerAndInvokeFallback:e=>{He.takeSnapshotOfSlotPosition(e.options.arid),He.updateNoInventoryViewability(e.options.arid),He.sendMessageToAd(e.options.arid,"handleFallbackBehavior",{});const t=de(20,He.updateNoInventoryViewability);this.addAdHandler(e.options.arid,e.options.slot,"noInventoryViewabilityTracker",(()=>{t(e.options.arid)})),window.addEventListener("scroll",this.ADS_HANDLERS[e.options.arid].noInventoryViewabilityTracker),window.addEventListener("resize",this.ADS_HANDLERS[e.options.arid].noInventoryViewabilityTracker),document.addEventListener("visibilitychange",this.ADS_HANDLERS[e.options.arid].noInventoryViewabilityTracker)},loadAdFeedback:(e,t)=>{const n=He.adMap[e.options.arid].iframe;e.options.adCreativeMetaData=t,qe(n,e.options,this.AD_TRACERS)},safeFrameReady:e=>{var t;(null===(t=e.options.expParams)||void 0===t?void 0:t.ilmRelocatedHtmlIsActive)&&!e.options.htmlContentEncoded&&Gt(e.options.arid,(()=>{Pe(this.AD_IDS[e.options.arid].placementDivId)}))},requestVideoAutoplay:(e,t)=>{et(e,t,He)},releaseVideoAutoplay:()=>{tt()},haveVideoAutoplayPermission:e=>{nt(e)},logSafeframeResourceTimingData:(e,t)=>{new Dt(e,t).log()},saveAdDetailsForAdReporter:(e,t)=>{if(!window.adReporterConfig)return;window.adReporterDetails||(window.adReporterDetails={});const n=e.options.slotName;t&&n===t.slotName?window.adReporterDetails[n]=t:window.adReporterDetails[n]||(window.adReporterDetails[n]=JSON.stringify(e))},feedbackLabelRendered:(e,t)=>{},feedbackOpenModal:e=>{}}),e(this,"initSafeFrame",(()=>{if(window.DAsf&&window.DAsf.loadAds)return void window.DAsf.loadAds();var e,t,a,o;window.DAsf={version:this.buildTimeReplacements.version},"t1"===(null===window||void 0===window||null===(e=window.renderingWeblabs)||void 0===e||null===(t=e.ADPT_SF_MRC_JAV_606654)||void 0===t?void 0:t.toLowerCase())?(z(null,null,ct.TREATMENT,1),st().forEach((e=>{try{Jt(e,document.body),z(null,null,ct.IMPRESSION,1),Ge(pt.IMPRESSION)}catch(e){z(null,null,ct.ERROR,1),Ge(pt.ERROR)}}))):"c"===(null===window||void 0===window||null===(a=window.renderingWeblabs)||void 0===a||null===(o=a.ADPT_SF_MRC_JAV_606654)||void 0===o?void 0:o.toLowerCase())?z(null,null,ct.CONTROL,1):(z(null,null,ct.NO_WEBLAB,1),it()),window.csa&&(Ue.events=window.csa("Events",{producerId:"adplacements"})),z(null,null,V.VERSION+":"+window.DAsf.version,1),Ge(A.VERSION+window.DAsf.version),window.addEventListener("message",He.receiveMessage,!1),He.supportedCommands=this.supportedCommands,window.DAsf.registerCustomMessageListener=He.registerCustomMessageListener,window.DAsf.sendCustomMessage=He.sendCustomMessage;window.DAsf.loadAds=()=>{const e="data-arid",t=(e,t)=>{this.AD_IDS[e]={slotId:t,placementDivId:"ape_"+t+"_placement",iframeId:"ape_"+t+"_iframe",auiCardDeckId:"ape_"+t+"_aui_cardDeck"}},a=e=>{const t={};try{const n=window.location.search.substring(1).split("&");for(let a=0;a<n.length;a++){const o=n[a].split("="),i=o[0];o.length>1&&e.indexOf(i)>-1&&(t[i]=o[1])}}catch(e){be("Error parsing query parameters",e)}return t},o=e=>()=>{ke(e.arid,e.size.width,e.size.height,e.maxAdWidth,He,this.AD_IDS)},i=e=>()=>{Ce(e.arid,this.AD_IDS,e.resizePlacementStyle)},r=t=>p((()=>{const n={callbackOccurred:!0};n.loadAfter=t.loadAfter,this.AD_TRACERS[t.arid].logTrace("pageCallBack",n),z(t.slot,t.placementId,N.CALLBACK,1),Ge(E.CALLBACK,t.slot,t.placementId);if(((t,n)=>{if(!t)return!1;const a=document.getElementById(t);if(a&&!a.innerHTML){const t=a.getAttribute(e);if(t&&t===n.arid)return!0}return!1})(this.AD_IDS[t.arid].placementDivId,t)){var a;Wt(t,t.safeFrameSrc,this.buildTimeReplacements.desktopSafeFrameClientHtmlContentEncoded,this.AD_IDS,this.AD_TRACERS,!1);const e=null===(a=null==He?void 0:He.adMap[null==t?void 0:t.arid])||void 0===a?void 0:a.iframe;e&&We(e,t,this.AD_TRACERS)}}),be,"Error in callback to create Safeframe."),s="text/x-dacx-safeframe";let d=document.getElementsByClassName(s);0===d.length&&(d=document.getElementsByTagName("script"));for(const l of d)if("DIV"===l.tagName&&l.classList.contains(s)||l.getAttribute("type")===s)try{const s=F(l.getAttribute("data-csa-c-slot-id")),d=s||JSON.parse(l.getAttribute("data-ad-details")||l.text||l.innerHTML||l.innerText);Ke(d);const u="ape_"+d.slot+"_placement",p=document.getElementById(u);!He.adMap[d.arid]&&p&&p.innerHTML&&(p.innerHTML="",l.removeAttribute(e));if(l.getAttribute(e))continue;d.arid=d.arid||Math.random().toString(16).slice(2),this.AD_TRACERS[d.arid]=new n(d.traceId,window[d.slotName]&&window[d.slotName].adStartTime||0),this.AD_TRACERS[d.arid].logTrace("safeFrameInput",d);const m={caches:window.caches?window.caches:null,plugins:document.plugins?document.plugins:null,cookies:document.cookie?document.cookie:null,userAgents:navigator.userAgent?navigator.userAgent:null};this.AD_TRACERS[d.arid].logTrace("browserData",m),l.setAttribute(e,d.arid),d.hostDomain=location.protocol+"//"+location.host,d.allowedSizes="object"==typeof d.allowedSizes&&d.allowedSizes.length>=0?d.allowedSizes.concat(d.size):[d.size];const f="d3l3lkinz3f56t.cloudfront.net,g-ecx.images-amazon.com,z-ecx.images-amazon.com,images-na.ssl-images-amazon.com,g-ec4.images-amazon.com,images-cn.ssl-images-amazon.com".split(",");if(d.allowedDomains="object"==typeof d.allowedDomains&&d.allowedDomains.length>=0?d.allowedDomains.concat(f):f,d.queryParams=a(d.allowlistedQueryParamKeys),d.aPageStart=window.aPageStart,d.adStartTime=window[d.slotName]&&window[d.slotName].adStartTime||0,this.addAdHandler(d.arid,d.slot,"defaultResizeSafeFrameHandler",o(d)),this.addAdHandler(d.arid,d.slot,"defaultSetResizePlacementStyle",i(d)),t(d.arid,d.slot),"clickTracking"in d&&""===d.clickTracking&&(d.clickTracking=c(d)),d.forcePunt){B("forcePunt",d.slot,d.placementId),Je({forcePunt:"true"}),Pe(this.AD_IDS[d.arid].placementDivId);continue}const g=Te(),y="true"===d.abpAcceptable&&("1"===d.abpStatus||"-1"===d.abpStatus);if(h(d.mediaType,d.adCreativeMetaData.adProgramId)){const e=g+this.buildTimeReplacements.desktopSafeFrameVideoPath,t=g+this.buildTimeReplacements.allowlistedSafeFrameVideoPath;d.safeFrameSrc=y?t:e}else{const e=g+this.buildTimeReplacements.desktopSafeFramePath,t=g+this.buildTimeReplacements.allowlistedSafeFramePath;d.safeFrameSrc=y?t:e}if(d.abpStatus){B("ABPStatus"+w[d.abpStatus],d.slot),Je({ABPStatus:w[d.abpStatus]});for(const e in w)z(d.slot,d.placementId,U[e],d.abpStatus===e?1:0),d.abpStatus===e&&Ge(I[e],d.slot,d.placementId)}d.collectSafeframeRTD=window.collectSafeframeRTD,ce().sendLatencyMetric({latencyMetricType:Ee,placementId:d.placementId,placementName:d.slot}),ce().sendLatencyMetric({latencyMetricType:we,placementId:d.placementId,placementName:d.slot}),ce().sendLatencyMetric({latencyMetricType:ge,placementId:d.placementId,placementName:d.slot}),z(d.slot,d.placementId,N.START,1),Ge(E.START,d.slot,d.placementId);const S={hostDomain:d.hostDomain,allowedSizes:d.allowedSizes,allowedDomains:d.allowedDomains,queryParams:d.queryParams,aPageStart:d.aPageStart,adStartTime:d.adStartTime,safeFrameSrc:d.safeFrameSrc,abpStatus:d.abpStatus};ze(d.loadAfter,r(d),0,l),S.loadAfter=d.loadAfter,this.AD_TRACERS[d.arid].logTrace("additionalInitilizationParams",S)}catch(e){be("Error parsing sf tag",e)}},window.DAsf.loadAds()})),this.buildTimeReplacements=t}}({version:"1.50.7e1f41e",desktopSafeFrameVideoPath:"/images/S/apesafeframe/ape/sf/desktop/sfVideo-1.50.7e1f41e.html",allowlistedSafeFrameVideoPath:"/images/S/apesafeframe/ape/sf/whitelisted/desktop/sfVideo-1.50.7e1f41e.html",desktopSafeFramePath:"/images/S/apesafeframe/ape/sf/desktop/sf-1.50.7e1f41e.html",allowlistedSafeFramePath:"/images/S/apesafeframe/ape/sf/whitelisted/desktop/sf-1.50.7e1f41e.html",desktopSafeFrameClientHtmlContentEncoded:"~~desktopSafeFrameClientHtmlContentEncoded~~"});p((()=>Qt.initSafeFrame()),be,"Error initializing safeFrame")()}();
//# sourceMappingURL=DAsf.min.js.map
